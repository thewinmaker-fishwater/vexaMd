# SP MD Viewer - 기능 정리

## 개요
SP MD Viewer는 Tauri 2.0 기반의 초경량 마크다운 뷰어입니다.

---

## 1. 기본 기능

### 파일 열기
- **Ctrl+O**: 파일 열기 다이얼로그
- **드래그 앤 드롭**: 파일을 앱에 드래그하여 열기
- 지원 형식: `.md`, `.markdown`, `.txt`

### 탭 시스템
- 여러 파일을 탭으로 열기
- **홈 탭**: 항상 첫 번째 위치
- **Ctrl+W**: 현재 탭 닫기
- **Ctrl+Tab**: 다음 탭으로 전환

### 최근 파일
- 최근 열었던 파일 10개 저장
- 홈 화면에서 빠른 접근
- 툴바 시계 버튼으로 목록 확인

---

## 2. 테마 시스템

### 기본 테마 (라이트/다크)
- **Ctrl+D**: 라이트/다크 모드 전환
- 시스템 테마와 독립적으로 동작

### 컬러 테마
툴바 콤보박스에서 선택:
- 기본 (그레이)
- 퍼플
- 오션
- 선셋
- 포레스트
- 로즈
- **커스텀** (사용자 정의)

### 커스텀 테마
테마 콤보박스에서 프리셋 선택 후 커스터마이저에서 수정하면 "커스텀"으로 저장됨.

---

## 3. 테마 커스터마이저

### 접근 방법
- 툴바의 톱니바퀴 버튼 클릭

### 편집 가능 항목

#### 기본 색상
- 배경색, 텍스트 색상, 강조 색상, 테두리 색상

#### 글꼴
- 본문 글꼴 (시스템, Noto Sans KR, 맑은 고딕 등)
- 줄 간격

#### 코드 블록
- 배경색, 텍스트 색상
- 코드 글꼴 (Consolas, Fira Code, JetBrains Mono, D2Coding)

#### 인용문
- 배경색, 테두리 색상, 테두리 두께

#### 테이블
- 헤더 배경/텍스트 색상, 테두리 반경

#### 제목
- H1/H2 색상, 그라데이션 사용 여부

#### 텍스트 마크
- 링크, 굵은글씨, 기울임, 하이라이트, 목록 마커 색상

#### 툴바
- 툴바 배경색 (그라데이션), 탭바 배경색

### CSS 직접 편집
- "CSS 편집" 탭에서 CSS 변수 및 스타일 직접 수정 가능

### 버튼
- **초기화**: 기본 설정으로 복원
- **가져오기**: JSON 파일에서 테마 불러오기
- **내보내기**: 현재 테마를 JSON 파일로 저장
- **취소**: 변경 취소하고 닫기
- **미리보기**: 변경사항 미리 적용
- **적용**: 변경사항 저장 및 적용

---

## 4. 뷰 모드

### 한 페이지 / 여러 페이지로 보기
- 툴바 버튼으로 전환
- **한 페이지 보기**: 전체 내용 연속 스크롤
- **여러 페이지로 보기**: `---` 구분선 기준 페이징
  - 페이지 번호 직접 입력하여 이동 가능
  - 화살표 키(←/→)로 페이지 이동

### 콘텐츠 너비
- 좁게 (900px), 보통 (1200px), 넓게 (1600px), 전체 너비

---

## 5. 프레젠테이션 모드

- **F5**: 프레젠테이션 시작
- 전체 화면 슬라이드쇼
- `---` 구분선 기준 페이지 분할
- **키보드 네비게이션**: ←/→, Space
- **ESC**: 종료

---

## 6. 줌 기능

- **Ctrl++/-/0**: 확대/축소/리셋
- **Ctrl+스크롤**: 마우스 휠 줌
- 줌 레벨: 50% ~ 200%
- **Pan 기능**: 100% 초과 확대 시 마우스 드래그로 콘텐츠 이동
  - 커서: `grab` → `grabbing` 시각적 피드백
  - 링크, 버튼 등 인터랙티브 요소에서는 드래그 비활성화

---

## 7. 검색 기능

- **Ctrl+F**: 검색창 열기
- 실시간 검색 및 하이라이트
- Enter/Shift+Enter: 다음/이전 결과

---

## 8. 다국어 지원

- **한국어 / English / 日本語** 지원
- 툴바 드롭다운에서 언어 선택
- 모든 UI 요소 동적 번역

---

## 9. 도움말 메뉴

- **단축키**: 모든 키보드 단축키 안내 모달
- **프로그램 정보**: Seven Peaks 로고, 버전, 개발사 정보

---

## 10. 인쇄

- **Ctrl+P**: 인쇄 다이얼로그
- **용지 자동 맞춤**: 프린터에서 선택한 용지 크기에 자동 맞춤
- **인쇄 최적화**:
  - 코드 블록: 자동 줄바꿈
  - 테이블: 자동 너비 조정 및 페이지 넘김 처리
  - 이미지: 최대 너비 100%로 자동 스케일
  - 제목: 페이지 나눔 방지

---

## 11. GitHub 스타일 Alert Box

마크다운에서 GitHub 스타일 알림 박스 지원:

```markdown
> [!NOTE]
> 참고 사항입니다.

> [!TIP]
> 유용한 팁입니다.

> [!IMPORTANT]
> 중요한 정보입니다.

> [!WARNING]
> 경고 메시지입니다.

> [!CAUTION]
> 주의가 필요합니다.
```

- 5가지 타입: NOTE (파랑), TIP (초록), IMPORTANT (보라), WARNING (노랑), CAUTION (빨강)
- 다크모드 지원
- 인쇄 시 색상 유지

---

## 12. 싱글 인스턴스

- MD 파일 더블클릭 시 새 앱이 열리지 않고 기존 앱의 새 탭으로 열림
- 기존 윈도우 자동 활성화 (포커스)

---

## 13. 파일 시스템 감시 (자동 리로드)

- 열린 파일이 외부에서 수정되면 자동으로 새로고침
- 실시간 감시 (watchImmediate 사용)
- 디바운싱 적용 (300ms)으로 중복 이벤트 방지
- 탭 닫을 때 자동으로 감시 해제

---

## 14. 이미지 확대 모달

- **이미지 클릭**: 마크다운 내 이미지 클릭 시 확대 모달 표시
- **줌 컨트롤**: 확대/축소/원래 크기 버튼
- **마우스 휠 줌**: 모달 내에서 마우스 휠로 확대/축소
- **드래그 이동**: 확대 상태에서 이미지 드래그로 이동
- **닫기**: X 버튼, 배경 클릭, ESC 키로 닫기

---

## 15. TOC 사이드바 (목차)

- **Ctrl+Shift+T**: TOC 사이드바 토글
- **자동 생성**: 마크다운 헤딩(h1~h6) 기반 목차 자동 생성
- **스크롤 이동**: 목차 항목 클릭 시 해당 섹션으로 부드럽게 스크롤
- **스크롤 스파이**: 현재 보고 있는 섹션 자동 하이라이트
- **탭별 상태**: 탭별로 TOC 표시 상태 독립 관리

---

## 16. PDF 내보내기

- **툴바 버튼**: PDF 아이콘 버튼으로 내보내기
- **A4 용지**: 자동 페이지 분할
- **파일명**: 현재 문서 이름.pdf로 저장
- **다국어 지원**: 내보내기 진행/완료 메시지 다국어 지원

---

## 17. 코드 문법 하이라이트

- **highlight.js**: 180+ 프로그래밍 언어 지원
- **자동 감지**: 코드 블록 언어 자동 감지
- **GitHub 스타일**: GitHub 스타일 문법 색상
- **테마 연동**: 라이트/다크 테마별 최적화된 색상

지원 언어 예시: JavaScript, TypeScript, Python, Java, C/C++, Go, Rust, HTML, CSS, JSON, YAML, Bash 등

---

## 18. 코드 블록 복사 버튼

- **호버 시 표시**: 코드 블록에 마우스를 올리면 복사 버튼 표시
- **원클릭 복사**: 버튼 클릭 시 코드 클립보드 복사
- **피드백**: 복사 완료 시 ✓ 체크 표시 (2초간)
- **언어 라벨**: 코드 블록 좌측 상단에 언어명 표시

---

## 19. 여러 커스텀 테마 저장

- **테마 프리셋**: 여러 개의 커스텀 테마를 이름과 함께 저장
- **불러오기**: 저장된 테마 클릭으로 즉시 적용
- **삭제**: 불필요한 테마 삭제
- **드롭다운 연동**: 컬러 테마 드롭다운에 저장된 테마 표시 (★ 표시)

---

## 20. 세션 복원

- **탭 복원**: 앱 종료 후 재실행 시 이전에 열었던 탭들 자동 복원
- **활성 탭 복원**: 마지막 활성 탭도 복원
- **삭제 파일 처리**: 존재하지 않는 파일은 자동 건너뛰기
- **CLI 우선**: 파일 더블클릭으로 열면 세션 복원 대신 해당 파일 열기

---

## 21. 윈도우 상태 기억

- **위치/크기 저장**: 앱 종료 시 윈도우 위치, 크기, 최대화 상태 저장
- **자동 복원**: 다음 실행 시 동일한 위치/크기로 복원
- **저장 위치**: `%APPDATA%/com.vexa-md/window-state.json`

---

## 22. 읽기전용 포맷 (.vmd)

- **내보내기**: 도구 > "읽기전용 내보내기"로 `.vmd` 파일 생성
- **AES-256-GCM 암호화**: 외부 에디터에서 내용 열람 불가
- **읽기전용 모드**: `.vmd` 파일 열기 시 편집/분할 모드 비활성화
- **🔒 아이콘**: 읽기전용 탭에 잠금 아이콘 표시
- **MD 변환**: 읽기전용 탭에서 도구 > "MD로 내보내기"로 Markdown 파일로 변환
- **메뉴 자동 전환**: 일반 탭에서는 VMD 내보내기만, VMD 탭에서는 MD 내보내기만 활성화
- **지원 경로**: 파일 열기 다이얼로그, 드래그앤드롭, 싱글 인스턴스 모두 `.vmd` 지원

### 암호화 키 관리
- **VMD v2 파일 포맷**: `MAGIC(4) + VERSION(1, 0x02) + KEY_NAME_LEN(1) + KEY_NAME(N) + NONCE(12) + ENCRYPTED_DATA`
  - v1(기존) 파일과 하위호환: v1 자동 감지 후 내장키로 복호화
- **내장키**: 앱 바이너리에 하드코딩된 기본 암호화 키
- **사용자 키**: 키 관리(도구 > "암호화 키 관리")에서 생성/편집/삭제
  - 랜덤 32바이트 키 자동 생성 (키생성 버튼)
  - hex 값은 읽기전용, 키생성으로만 변경 가능
  - 기본키 지정 (별표 아이콘)
- **키 내보내기/가져오기**: JSON 파일로 키 공유 (중복 체크: 이름 + 키값)
- **내보내기 시 키 선택**: 기본키 또는 저장된 사용자 키 선택
- **열기 시 키 매칭**: 파일 헤더의 키 이름으로 저장된 키 자동 매칭, 없으면 키 입력 모달 표시
- **키 정보 표시**: 탭에 키 이름 뱃지, 뷰어 상단에 키 정보 배너
- **세션 복원**: VMD 파일 복원 시 키 자동 매칭
- **삭제 확인**: 테마 적용된 커스텀 확인 다이얼로그

---

## 23. 단축키 정리

| 단축키 | 기능 |
|--------|------|
| Ctrl+O | 파일 열기 |
| Ctrl+D | 라이트/다크 전환 |
| Ctrl+P | 인쇄 |
| Ctrl+F | 검색 |
| Ctrl+Shift+T | TOC 사이드바 토글 |
| Ctrl+E | 테마 내보내기 |
| Ctrl+W | 탭 닫기 |
| Ctrl+Tab | 다음 탭 |
| Ctrl++/-/0 | 줌 |
| F5 | 프레젠테이션 |
| Ctrl+S | 저장 (편집 모드) |
| ←/→ | 페이지/슬라이드 이동 |
| Space | 다음 슬라이드 (프레젠테이션) |
| Esc | 홈으로 / 종료 |

---

## 24. 플러그인 시스템 (Phase 2)

### plugin.json 매니페스트
- **매니페스트 기반 등록**: `plugin.json` 파일로 플러그인 메타데이터 정의
- **필수 필드**: `id`, `name`, `version`, `main`
- **매니페스트 검증**: 잘못된 매니페스트 자동 감지 및 경고

### 고급 설정 폼
- **스키마 기반 렌더링**: plugin.json의 `settings` 필드에서 자동 폼 생성
- **지원 타입**: string, boolean, number, select, color, textarea, range
- **다국어 라벨**: 설정 라벨에 i18n 객체 지원 (`{ "ko": "...", "en": "..." }`)
- **도움말 텍스트**: 각 설정 필드에 선택적 도움말 표시

### 플러그인 설치/제거
- **폴더 설치**: Tauri 다이얼로그로 플러그인 폴더 선택 → 자동 설치
- **외부 플러그인 스캔**: `{appDataDir}/plugins/` 디렉터리 자동 스캔
- **플러그인 삭제**: 비내장 플러그인 삭제 기능 (확인 다이얼로그)
- **설치 유형 배지**: 내장 / 사용자 설치 구분 표시

### 에러 UI
- **에러 카드**: 로드 실패 플러그인 붉은 테두리로 표시
- **에러 메시지**: 인라인 에러 메시지 표시
- **재시도 버튼**: 실패한 플러그인 재로드 시도
- **에러 상세**: `<details>` 태그로 전체 스택 트레이스 확장 가능

### 템플릿 플러그인
- **개발자 시작점**: `src/plugins/template/` 에 주석 포함 템플릿 제공
- **모든 설정 타입 예시**: string, boolean, select, range 예시 포함

---

## 25. 내장 플러그인

### Reading Time (읽기 시간)
- 문서의 예상 읽기 시간을 툴바에 표시
- 3그룹 언어별 읽기 속도 차등 적용: 한국어 500CPM, CJK(중/일) 400CPM, Latin/Cyrillic 200WPM
- 혼합 언어 문서 지원 (각 언어 비율에 따라 계산)

### Auto TOC Insert (목차 자동 삽입)
- 마크다운 `[TOC]` 마커 위치에 목차 자동 생성
- 설정 가능한 최대 깊이 (h1~h6)
- 목차 항목 클릭 시 부드러운 스크롤 이동

### Image Zoom (이미지 확대)
- `#content` 내 이미지 클릭 시 라이트박스 오버레이로 확대
- 배경 투명도 설정 가능
- ESC 또는 배경 클릭으로 닫기

### Footnote (각주)
- `[^id]` 인라인 참조와 `[^id]: text` 정의 렌더링
- 상단 참조 → 하단 각주 섹션 자동 생성
- 백링크(↩) 지원

### Copy as HTML (HTML 복사)
- 툴바 버튼으로 렌더링된 마크다운을 HTML로 클립보드 복사
- `text/html` + `text/plain` 동시 복사

### Emoji Replace (이모지 변환)
- `:smile:`, `:heart:` 등 ~150개 숏코드를 이모지로 자동 변환
- 코드 블록 내부는 변환 제외

### External Link Icon (외부 링크 아이콘)
- `http(s)://` 외부 링크 옆에 SVG 아이콘 표시
- 아이콘 표시 on/off 설정

### Highlight Search (키워드 하이라이팅)
- 쉼표로 구분된 키워드를 뷰어에서 영구 하이라이팅
- 하이라이트 색상 설정 (컬러 피커)
- 대소문자 구분 설정
- 코드 블록 내부는 하이라이팅 제외

---

## 문서 히스토리

| 날짜 | 변경 내용 |
|------|----------|
| 2026-02-01 | 내장 플러그인 8종 추가 (reading-time, auto-toc-insert, image-zoom, footnote, copy-as-html, emoji-replace, external-link-icon, highlight-search) |
| 2026-01-31 | 플러그인 시스템 Phase 2 추가 (매니페스트, 설정 폼, 설치/삭제, 에러 UI) |
| 2026-01-24 | 마크다운 편집 기능 (Ctrl+S) 추가 |
| 2026-01-22 | TOC 사이드바 단축키 추가 |
| 2025-12-26 | 초기 문서 작성 |

*마지막 업데이트: 2026-02-01*
